// ColorBox v1.3.13 - a full featured, light-weight, customizable lightbox based on jQuery 1.3+
// Copyright (c) 2010 Jack Moore - jack@colorpowered.com
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
(function(b,jb){var t="none",N="LoadedContent",x="resize.",o="y",q="auto",M="nofollow",m="x",e=true,c=false,fb={transition:"elastic",speed:300,width:c,initialWidth:"600",innerWidth:c,maxWidth:c,height:c,initialHeight:"450",innerHeight:c,maxHeight:c,scalePhotos:e,scrolling:e,inline:c,html:c,iframe:c,photo:c,href:c,title:c,rel:c,opacity:.9,preloading:e,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:c,returnFocus:e,loop:e,slideshow:c,slideshowAuto:e,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:c,onLoad:c,onComplete:c,onCleanup:c,onClosed:c,overlayClose:e,escKey:e,arrowKey:e},s="colorbox",i="cbox",eb=i+"_open",W=i+"_load",Q=i+"_complete",L=i+"_cleanup",cb=i+"_closed",U=i+"_purge",db=i+"_loaded",E=b.browser.msie&&!b.support.opacity,bb=E&&b.browser.version<7,O=i+"_IE6",y,j,C,r,V,T,S,R,h,n,k,G,F,ab,X,H,J,K,Z,A,B,v,w,l,g,a,u,D,P=c,d,I=i+"Element";function f(c,a){c=c?' id="'+i+c+'"':"";a=a?' style="'+a+'"':"";return b("<div"+c+a+"/>")}function p(a,b){b=b===m?n.width():n.height();return typeof a==="string"?Math.round(/%/.test(a)?b/100*parseInt(a,10):parseInt(a,10)):a}function Y(b){return a.photo||/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i.test(b)}function gb(a){for(var c in a)if(b.isFunction(a[c])&&c.substring(0,2)!=="on")a[c]=a[c].call(l);a.rel=a.rel||l.rel||M;a.href=a.href||b(l).attr("href");a.title=a.title||l.title;return a}function z(c,a){a&&a.call(l);b.event.trigger(c)}function ib(){var c,b=i+"Slideshow_",e="click."+i,f,k,l;if(a.slideshow&&h[1]){f=function(){H.text(a.slideshowStop).unbind(e).bind(Q,function(){if(g<h.length-1||a.loop)c=setTimeout(d.next,a.slideshowSpeed)}).bind(W,function(){clearTimeout(c)}).one(e+" "+L,k);j.removeClass(b+"off").addClass(b+"on");c=setTimeout(d.next,a.slideshowSpeed)};k=function(){clearTimeout(c);H.text(a.slideshowStart).unbind([Q,W,L,e].join(" ")).one(e,f);j.removeClass(b+"on").addClass(b+"off")};if(a.slideshowAuto)f();else k()}}function hb(c){if(!P){l=c;a=gb(b.extend({},b.data(l,s)));h=b(l);g=0;if(a.rel!==M){h=b("."+I).filter(function(){var c=b.data(this,s).rel||this.rel;return c===a.rel});g=h.index(l);if(g===-1){h=h.add(l);g=h.length-1}}if(!u){u=D=e;j.show();if(a.returnFocus)try{l.blur();b(l).one(cb,function(){try{this.focus()}catch(a){}})}catch(f){}y.css({opacity:+a.opacity,cursor:a.overlayClose?"pointer":q}).show();a.w=p(a.initialWidth,m);a.h=p(a.initialHeight,o);d.position(0);bb&&n.bind(x+O+" scroll."+O,function(){y.css({width:n.width(),height:n.height(),top:n.scrollTop(),left:n.scrollLeft()})}).trigger("scroll."+O);z(eb,a.onOpen);X.add(K).add(J).add(H).add(ab).hide();Z.html(a.close).show()}d.load(e)}}d=b.fn[s]=b[s]=function(c,f){var a=this,d;if(!a[0]&&a.selector)return a;c=c||{};if(f)c.onComplete=f;if(!a[0]||a.selector===undefined){a=b("<a/>");c.open=e}a.each(function(){b.data(this,s,b.extend({},b.data(this,s)||fb,c));b(this).addClass(I)});d=c.open;if(b.isFunction(d))d=d.call(a);d&&hb(a[0]);return a};d.init=function(){var l="hover",m="clear:left";n=b(jb);j=f().attr({id:s,"class":E?i+"IE":""});y=f("Overlay",bb?"position:absolute":"").hide();C=f("Wrapper");r=f("Content").append(k=f(N,"width:0; height:0; overflow:hidden"),F=f("LoadingOverlay").add(f("LoadingGraphic")),ab=f("Title"),X=f("Current"),J=f("Next"),K=f("Previous"),H=f("Slideshow").bind(eb,ib),Z=f("Close"));C.append(f().append(f("TopLeft"),V=f("TopCenter"),f("TopRight")),f(c,m).append(T=f("MiddleLeft"),r,S=f("MiddleRight")),f(c,m).append(f("BottomLeft"),R=f("BottomCenter"),f("BottomRight"))).children().children().css({"float":"left"});G=f(c,"position:absolute; width:9999px; visibility:hidden; display:none");b("body").prepend(y,j.append(C,G));r.children().hover(function(){b(this).addClass(l)},function(){b(this).removeClass(l)}).addClass(l);A=V.height()+R.height()+r.outerHeight(e)-r.height();B=T.width()+S.width()+r.outerWidth(e)-r.width();v=k.outerHeight(e);w=k.outerWidth(e);j.css({"padding-bottom":A,"padding-right":B}).hide();J.click(d.next);K.click(d.prev);Z.click(d.close);r.children().removeClass(l);b("."+I).live("click",function(a){if(!(a.button!==0&&typeof a.button!=="undefined"||a.ctrlKey||a.shiftKey||a.altKey)){a.preventDefault();hb(this)}});y.click(function(){a.overlayClose&&d.close()});b(document).bind("keydown",function(b){if(u&&a.escKey&&b.keyCode===27){b.preventDefault();d.close()}if(u&&a.arrowKey&&!D&&h[1])if(b.keyCode===37&&(g||a.loop)){b.preventDefault();K.click()}else if(b.keyCode===39&&(g<h.length-1||a.loop)){b.preventDefault();J.click()}})};d.remove=function(){j.add(y).remove();b("."+I).die("click").removeData(s).removeClass(I)};d.position=function(h,d){var e,g=Math.max(document.documentElement.clientHeight-a.h-v-A,0)/2+n.scrollTop(),f=Math.max(n.width()-a.w-w-B,0)/2+n.scrollLeft();e=j.width()===a.w+w&&j.height()===a.h+v?0:h;C[0].style.width=C[0].style.height="9999px";function b(a){V[0].style.width=R[0].style.width=r[0].style.width=a.style.width;F[0].style.height=F[1].style.height=r[0].style.height=T[0].style.height=S[0].style.height=a.style.height}j.dequeue().animate({width:a.w+w,height:a.h+v,top:g,left:f},{duration:e,complete:function(){b(this);D=c;C[0].style.width=a.w+w+B+"px";C[0].style.height=a.h+v+A+"px";d&&d()},step:function(){b(this)}})};d.resize=function(b){if(u){b=b||{};if(b.width)a.w=p(b.width,m)-w-B;if(b.innerWidth)a.w=p(b.innerWidth,m);k.css({width:a.w});if(b.height)a.h=p(b.height,o)-v-A;if(b.innerHeight)a.h=p(b.innerHeight,o);if(!b.innerHeight&&!b.height){var c=k.wrapInner("<div style='overflow:auto'></div>").children();a.h=c.height();c.replaceWith(c.children())}k.css({height:a.h});d.position(a.transition===t?0:a.speed)}};d.prep=function(v){var e="hidden";if(!u)return;var w,l=a.transition===t?0:a.speed;n.unbind(x+i);k.remove();k=f(N).html(v);function p(){a.w=a.w||k.width();a.w=a.mw&&a.mw<a.w?a.mw:a.w;return a.w}function o(){a.h=a.h||k.height();a.h=a.mh&&a.mh<a.h?a.mh:a.h;return a.h}k.hide().appendTo(G.show()).css({width:p(),overflow:a.scrolling?q:e}).css({height:o()}).prependTo(r);G.hide();b("#"+i+"Photo").css({cssFloat:t,marginLeft:q,marginRight:q});bb&&b("select").not(j.find("select")).filter(function(){return this.style.visibility!==e}).css({visibility:e}).one(L,function(){this.style.visibility="inherit"});function m(r){var p,f,o,e,m=h.length,q=a.loop;d.position(r,function(){function r(){if(E)j[0].style.filter=c}if(!u)return;if(E)w&&k.fadeIn(100);k.show();z(db);ab.show().html(a.title);if(m>1){typeof a.current==="string"&&X.html(a.current.replace(/\{current\}/,g+1).replace(/\{total\}/,m)).show();J[q||g<m-1?"show":"hide"]().html(a.next);K[q||g?"show":"hide"]().html(a.previous);p=g?h[g-1]:h[m-1];o=g<m-1?h[g+1]:h[0];a.slideshow&&H.show();if(a.preloading){e=b.data(o,s).href||o.href;f=b.data(p,s).href||p.href;e=b.isFunction(e)?e.call(o):e;f=b.isFunction(f)?f.call(p):f;if(Y(e))b("<img/>")[0].src=e;if(Y(f))b("<img/>")[0].src=f}}F.hide();if(a.transition==="fade")j.fadeTo(l,1,function(){r()});else r();n.bind(x+i,function(){d.position(0)});z(Q,a.onComplete)})}if(a.transition==="fade")j.fadeTo(l,0,function(){m(0)});else m(l)};d.load=function(u){var n,c,r,q=d.prep;D=e;l=h[g];if(!u)a=gb(b.extend({},b.data(l,s)));z(U);z(W,a.onLoad);a.h=a.height?p(a.height,o)-v-A:a.innerHeight&&p(a.innerHeight,o);a.w=a.width?p(a.width,m)-w-B:a.innerWidth&&p(a.innerWidth,m);a.mw=a.w;a.mh=a.h;if(a.maxWidth){a.mw=p(a.maxWidth,m)-w-B;a.mw=a.w&&a.w<a.mw?a.w:a.mw}if(a.maxHeight){a.mh=p(a.maxHeight,o)-v-A;a.mh=a.h&&a.h<a.mh?a.h:a.mh}n=a.href;F.show();if(a.inline){f().hide().insertBefore(b(n)[0]).one(U,function(){b(this).replaceWith(k.children())});q(b(n))}else if(a.iframe){j.one(db,function(){var c=b("<iframe name='"+(new Date).getTime()+"' frameborder=0"+(a.scrolling?"":" scrolling='no'")+(E?" allowtransparency='true'":"")+" style='width:100%; height:100%; border:0; display:block;'/>");c[0].src=a.href;c.appendTo(k)});q(" ")}else if(a.html)q(a.html);else if(Y(n)){c=new Image;c.onload=function(){var e;c.onload=null;c.id=i+"Photo";b(c).css({border:t,display:"block",cssFloat:"left"});if(a.scalePhotos){r=function(){c.height-=c.height*e;c.width-=c.width*e};if(a.mw&&c.width>a.mw){e=(c.width-a.mw)/c.width;r()}if(a.mh&&c.height>a.mh){e=(c.height-a.mh)/c.height;r()}}if(a.h)c.style.marginTop=Math.max(a.h-c.height,0)/2+"px";h[1]&&(g<h.length-1||a.loop)&&b(c).css({cursor:"pointer"}).click(d.next);if(E)c.style.msInterpolationMode="bicubic";setTimeout(function(){q(c)},1)};setTimeout(function(){c.src=n},1)}else n&&G.load(n,function(d,a,c){q(a==="error"?"Request unsuccessful: "+c.statusText:b(this).children())})};d.next=function(){if(!D){g=g<h.length-1?g+1:0;d.load()}};d.prev=function(){if(!D){g=g?g-1:h.length-1;d.load()}};d.close=function(){if(u&&!P){P=e;u=c;z(L,a.onCleanup);n.unbind("."+i+" ."+O);y.fadeTo("fast",0);j.stop().fadeTo("fast",0,function(){z(U);k.remove();j.add(y).css({opacity:1,cursor:q}).hide();setTimeout(function(){P=c;z(cb,a.onClosed)},1)})}};d.element=function(){return b(l)};d.settings=fb;b(d.init)})(jQuery,this)
